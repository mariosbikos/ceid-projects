

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>db-project Package &mdash; db-project 1.2.4 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.2.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="db-project 1.2.4 documentation" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="#">db-project 1.2.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="db-project-package">
<h1>db-project Package<a class="headerlink" href="#db-project-package" title="Permalink to this headline">¶</a></h1>
<p>Implementation of a relational database based on a b-tree structure</p>
<div class="section" id="testbench-module">
<h2><a class="reference internal" href="#module-testbench" title="testbench"><tt class="xref py py-mod docutils literal"><span class="pre">testbench</span></tt></a> module<a class="headerlink" href="#testbench-module" title="Permalink to this headline">¶</a></h2>
<p>Testbench for the database actions</p>
<span class="target" id="module-testbench"></span><dl class="function">
<dt id="testbench.full_testbench">
<tt class="descclassname">testbench.</tt><tt class="descname">full_testbench</tt><big>(</big><em>name</em>, <em>amount</em><big>)</big><a class="reference internal" href="_modules/testbench.html#full_testbench"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#testbench.full_testbench" title="Permalink to this definition">¶</a></dt>
<dd><p>This testbench tests the full functionality of the b-tree database and its relying functions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Name of the database</li>
<li><strong>amount</strong> (<em>integer</em>) &#8211; Amount of records that will be created in database</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is fully commented in the source. click [source] on the right</p>
</div>
</dd></dl>

<dl class="function">
<dt id="testbench.main">
<tt class="descclassname">testbench.</tt><tt class="descname">main</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/testbench.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#testbench.main" title="Permalink to this definition">¶</a></dt>
<dd><p>The main function that is called for testbench and profiling</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">There is a malfunction because i use <a class="reference internal" href="#db.createDatabase" title="db.createDatabase"><tt class="xref py py-func docutils literal"><span class="pre">db.createDatabase()</span></tt></a> to create my test database files.
When i produce a very large file(ex 10000), i have only 30 names so it is normal for the creation
of the secondary key indexes to have VERY large nodes that exceeds tha db.SIZE_BIG.
For the time i set it manually</p>
</div>
</dd></dl>

<dl class="function">
<dt id="testbench.print_all">
<tt class="descclassname">testbench.</tt><tt class="descname">print_all</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="_modules/testbench.html#print_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#testbench.print_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an database prints all the indexes created on this database</p>
</dd></dl>

<dl class="function">
<dt id="testbench.timingProfile">
<tt class="descclassname">testbench.</tt><tt class="descname">timingProfile</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="_modules/testbench.html#timingProfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#testbench.timingProfile" title="Permalink to this definition">¶</a></dt>
<dd><p>It is a test function that shows the difference between the linear search in a db file
and btree search.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the test i use a search on a secondary key index because it is the most general case
the function can test the times between all the indexes too..</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">To have a more accurate timing it is preferred to use externally the cProfile python module for profiling
usage: python -m cProfile testbench.py</p>
</div>
</dd></dl>

</div>
<div class="section" id="db-module">
<h2><a class="reference internal" href="#module-db" title="db"><tt class="xref py py-mod docutils literal"><span class="pre">db</span></tt></a> module<a class="headerlink" href="#db-module" title="Permalink to this headline">¶</a></h2>
<p>Database implementation based on a b-tree structure</p>
<span class="target" id="module-db"></span><dl class="function">
<dt id="db.checkInsert">
<tt class="descclassname">db.</tt><tt class="descname">checkInsert</tt><big>(</big><em>tr</em>, <em>nodekey</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/db.html#checkInsert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.checkInsert" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for <a class="reference internal" href="#btree.B_tree_insert" title="btree.B_tree_insert"><tt class="xref py py-func docutils literal"><span class="pre">btree.B_tree_insert()</span></tt></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tr</strong> (<a class="reference internal" href="#btree.BTreeNode" title="btree.BTreeNode"><tt class="xref py py-class docutils literal"><span class="pre">btree.BTreeNode</span></tt></a>) &#8211; The root of the btree we want to insert to</li>
<li><strong>nodekey</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; the nodekey we want to insert</li>
<li><strong>file</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#file" title="(in Python v2.7)"><em>file</em></a>) &#8211; The file descriptor of the index</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If the nodekey found in the index:</p>
<ul class="simple">
<li>If index is for primary key checks for duplicate and throws an error</li>
<li>If index is for secondary key instead of inserting a new nodekey appends the
record in the existing key</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="db.createDatabase">
<tt class="descclassname">db.</tt><tt class="descname">createDatabase</tt><big>(</big><em>name</em>, <em>size</em><big>)</big><a class="reference internal" href="_modules/db.html#createDatabase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.createDatabase" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for generating an example record file used for testing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str.</em>) &#8211; the name of the database</li>
<li><strong>size</strong> (<em>integer</em>) &#8211; the number of records in the record file</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>It is used to generate random IDs, surnames, names, year and age in order to create a test database,
every record is a dictionary that first is jsoned and then dumped into the file</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The databases files have .db extension</p>
</div>
</dd></dl>

<dl class="function">
<dt id="db.createIndex">
<tt class="descclassname">db.</tt><tt class="descname">createIndex</tt><big>(</big><em>name</em>, <em>filename</em>, <em>attr</em><big>)</big><a class="reference internal" href="_modules/db.html#createIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.createIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Middle function that creates index based on the attribute given</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of the database</li>
<li><strong>filename</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of the index</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The index files have .json extension and their names follows the following rule {attribute}_{dbname}.json
,also an index&#8217;s first line contains the number of the node that is root, namely the line number of this node</p>
</div>
</dd></dl>

<dl class="function">
<dt id="db.createPrimaryIndex">
<tt class="descclassname">db.</tt><tt class="descname">createPrimaryIndex</tt><big>(</big><em>name</em>, <em>filename</em><big>)</big><a class="reference internal" href="_modules/db.html#createPrimaryIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.createPrimaryIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that creates primary key indexes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of the database</li>
<li><strong>filename</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of the index</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="db.createSecondaryIndex">
<tt class="descclassname">db.</tt><tt class="descname">createSecondaryIndex</tt><big>(</big><em>name</em>, <em>filename</em>, <em>attr</em><big>)</big><a class="reference internal" href="_modules/db.html#createSecondaryIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.createSecondaryIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that creates secondary key indexes based on the given attribute(not primary key)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of the database</li>
<li><strong>filename</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; name of the index</li>
<li><strong>attr</strong> &#8211; the attribute (surname, name, year, age)</li>
<li><strong>type</strong> &#8211; string</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="db.delete">
<tt class="descclassname">db.</tt><tt class="descname">delete</tt><big>(</big><em>key</em>, <em>filename</em><big>)</big><a class="reference internal" href="_modules/db.html#delete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a primary key and an database file deletes the key from the database and all the indexes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> (<em>integer</em>) &#8211; the ID of the user to be deleted</li>
<li><strong>filename</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; the name of the database file</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>First searches the record file(database) for the given primary key and deletes it from the database
Then it uses <a class="reference internal" href="#db.deleteFromIndex" title="db.deleteFromIndex"><tt class="xref py py-func docutils literal"><span class="pre">db.deleteFromIndex()</span></tt></a> to delete the key from all the indexes that this database has</p>
</dd></dl>

<dl class="function">
<dt id="db.deleteFromIndex">
<tt class="descclassname">db.</tt><tt class="descname">deleteFromIndex</tt><big>(</big><em>indexname</em>, <em>keyP</em>, <em>keyS=None</em><big>)</big><a class="reference internal" href="_modules/db.html#deleteFromIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.deleteFromIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a record from an index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>indexname</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; the index&#8217;s filename</li>
<li><strong>keyP</strong> (<em>integer</em>) &#8211; A primary key</li>
<li><strong>keyS</strong> (<em>string/integer</em>) &#8211; A secondary key</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If the index is a primary key index it just deletes the record with the primary keyP
If the index is a secondary key index:</p>
<ul class="simple">
<li>searches in the btree the keyS using <a class="reference internal" href="#db.find" title="db.find"><tt class="xref py py-func docutils literal"><span class="pre">db.find()</span></tt></a></li>
<li>if found uses <a class="reference internal" href="#db.retrieve" title="db.retrieve"><tt class="xref py py-func docutils literal"><span class="pre">db.retrieve()</span></tt></a> to retrieve the records that the nodekey contains
else prints a message that the given keyS didn&#8217;t found in the index</li>
<li>if found checks the records to find matching records with the given keyP
then if the nodekey has only one record deletes the nodekey completely,
if the nodekey has multiple records with the keyS deletes only the one matching the keyP
if none of the records matches keyP prints error message</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="db.disk_read">
<tt class="descclassname">db.</tt><tt class="descname">disk_read</tt><big>(</big><em>block</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/db.html#disk_read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.disk_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for reading a b-tree node into a file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>block</strong> (<em>integer</em>) &#8211; a btree node number of line in the index</li>
<li><strong>file</strong> (<em>class _io.TextIOWrapper</em>) &#8211; the file to write to</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#btree.BTreeNode" title="btree.BTreeNode"><tt class="xref py py-class docutils literal"><span class="pre">btree.BTreeNode</span></tt></a></p>
</td>
</tr>
</tbody>
</table>
<p>It is used between the processing of an index to gain
read access of the given index. It fins the line in the index file
then uses json to recreate a BTreeNode and return it</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It uses constant json size of 200 for ID primary key index
and 500 for secondary key index. It may fail if node is too big</p>
</div>
</dd></dl>

<dl class="function">
<dt id="db.disk_write">
<tt class="descclassname">db.</tt><tt class="descname">disk_write</tt><big>(</big><em>object</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/db.html#disk_write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.disk_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for writing a b-tree node into a file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>object</strong> (<a class="reference internal" href="#btree.BTreeNode" title="btree.BTreeNode"><tt class="xref py py-class docutils literal"><span class="pre">btree.BTreeNode</span></tt></a>) &#8211; a btree node</li>
<li><strong>file</strong> &#8211; the file to write to</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>It is used between the processing of an index to gain
write access of the given index. It uses the json module
to write the given object into the file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It uses constant json size of 200 for ID primary key index
and 500 for secondary key index. It may fail if node is too big</p>
</div>
</dd></dl>

<dl class="function">
<dt id="db.find">
<tt class="descclassname">db.</tt><tt class="descname">find</tt><big>(</big><em>key</em>, <em>indexname</em><big>)</big><a class="reference internal" href="_modules/db.html#find"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a record in an index given a key</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> (<em>integer/string</em>) &#8211; The key to look for</li>
<li><strong>indexname</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; filename of the index</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple that contains a node and an index that points to a key in this node</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the difference between a key and a nodekey is that the key is a single value (integer or string) that is used to traverse the tree.
the nodekey is a struct-like object (list) that contains the key and the offset of the certain key in the record file. Each node has nodekeys
but it is traversed using the keys in the nodekeys</p>
</div>
</dd></dl>

<dl class="function">
<dt id="db.findRange">
<tt class="descclassname">db.</tt><tt class="descname">findRange</tt><big>(</big><em>key1</em>, <em>key2</em>, <em>indexname</em><big>)</big><a class="reference internal" href="_modules/db.html#findRange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.findRange" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds records in an index, in the range of two keys</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key1</strong> (<em>integer/string</em>) &#8211; The key down border</li>
<li><strong>key2</strong> (<em>integer/string</em>) &#8211; The key up border</li>
<li><strong>indexname</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; filename of the index</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="db.insertInDatabase">
<tt class="descclassname">db.</tt><tt class="descname">insertInDatabase</tt><big>(</big><em>record</em>, <em>filename</em><big>)</big><a class="reference internal" href="_modules/db.html#insertInDatabase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.insertInDatabase" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts a given record in the given database</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>record</strong> (<em>dictionary</em>) &#8211; the record</li>
<li><strong>filename</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; the database&#8217;s filename</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last">ValueError</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="db.insertInIndex">
<tt class="descclassname">db.</tt><tt class="descname">insertInIndex</tt><big>(</big><em>nodekey</em>, <em>indexname</em><big>)</big><a class="reference internal" href="_modules/db.html#insertInIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.insertInIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts a key into an index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nodekey</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; the nodekey to insert in the database</li>
<li><strong>indexname</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; filename of the index</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="db.makeRecord">
<tt class="descclassname">db.</tt><tt class="descname">makeRecord</tt><big>(</big><em>line</em><big>)</big><a class="reference internal" href="_modules/db.html#makeRecord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.makeRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for creating record dictionary given a properly formatted string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> (<em>str.</em>) &#8211; properly formatted string</td>
</tr>
<tr class="field-even field"><th class="field-name">Return record:</th><td class="field-body">the generated record</td>
</tr>
</tbody>
</table>
<p>Example of its function</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">makeRecord</span><span class="p">(</span><span class="s">&#39;5070 spyros seimenis 2 20&#39;</span><span class="p">)</span>
<span class="go">{&#39;age&#39;: 20, &#39;year&#39;: 2, &#39;surname&#39;: &#39;spyros&#39;, &#39;ID&#39;: 5070, &#39;name&#39;: &#39;seimenis&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="db.optimize">
<tt class="descclassname">db.</tt><tt class="descname">optimize</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/db.html#optimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is experimentally used to optimize/rebalance an index after creation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; index&#8217;s filename</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Experimental function, currently not working properly</p>
</div>
</dd></dl>

<dl class="function">
<dt id="db.printRecords">
<tt class="descclassname">db.</tt><tt class="descname">printRecords</tt><big>(</big><em>list</em><big>)</big><a class="reference internal" href="_modules/db.html#printRecords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.printRecords" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that formats a list of jsoned records into records(dictionaries) and prints them</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>list</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; list with jsoned records (from the record file)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="db.retrieve">
<tt class="descclassname">db.</tt><tt class="descname">retrieve</tt><big>(</big><em>nodekey</em>, <em>filename</em><big>)</big><a class="reference internal" href="_modules/db.html#retrieve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.retrieve" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for retrieving the lines from the database that a key of Btreenode is pointing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nodekey</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; a key of the class.BtreeNode</li>
<li><strong>filename</strong> (<em>str.</em>) &#8211; the file to write to</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return lines:</th><td class="field-body"><p class="first last">The lines from the database that the given key is pointing</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="db.tree_print">
<tt class="descclassname">db.</tt><tt class="descname">tree_print</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="_modules/db.html#tree_print"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#db.tree_print" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that prints the b-tree that an index contains</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="http://docs.python.org/library/string.html#string" title="(in Python v2.7)"><em>string</em></a>) &#8211; the index&#8217;s name</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="btree-module">
<h2><a class="reference internal" href="#module-btree" title="btree"><tt class="xref py py-mod docutils literal"><span class="pre">btree</span></tt></a> module<a class="headerlink" href="#btree-module" title="Permalink to this headline">¶</a></h2>
<p>B-tree implementation and some useful functions on it</p>
<span class="target" id="module-btree"></span><dl class="class">
<dt id="btree.BTreeNode">
<em class="property">class </em><tt class="descclassname">btree.</tt><tt class="descname">BTreeNode</tt><big>(</big><em>t=4</em>, <em>leaf=True</em>, <em>jsontemp=False</em><big>)</big><a class="reference internal" href="_modules/btree.html#BTreeNode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.BTreeNode" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the class that implements the btree nodes</p>
<p>a BTreeNode consists of:</p>
<ul class="simple">
<li>a nodeCounter that is given to him and it is unique that represents its relative position
with the others and the line of the node in the
index file</li>
<li>a boolean leaf that indicates if the current node is a leaf or not</li>
<li>a variable t that holds the type of the b-tree this node belongs to</li>
<li>a list with nodekeys. A nodekey is a list with its first element being the actual key and
the rest elements are the positions in the record file in which this key exists</li>
<li>a list with children. For each of the children of the node, its
num(nodeCounter) is stored in that list</li>
</ul>
<dl class="method">
<dt id="btree.BTreeNode.can_remove">
<tt class="descname">can_remove</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/btree.html#BTreeNode.can_remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.BTreeNode.can_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if the current node can remove keys</p>
</dd></dl>

<dl class="method">
<dt id="btree.BTreeNode.is_full">
<tt class="descname">is_full</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/btree.html#BTreeNode.is_full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.BTreeNode.is_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if node is full</p>
</dd></dl>

<dl class="method">
<dt id="btree.BTreeNode.keysremove">
<tt class="descname">keysremove</tt><big>(</big><em>key</em><big>)</big><a class="reference internal" href="_modules/btree.html#BTreeNode.keysremove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.BTreeNode.keysremove" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the given nodekey from the node</p>
</dd></dl>

<dl class="method">
<dt id="btree.BTreeNode.merge_children">
<tt class="descname">merge_children</tt><big>(</big><em>i</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/btree.html#BTreeNode.merge_children"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.BTreeNode.merge_children" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges children[i] and children[i+1] of the given node by pushing keys[i] down</p>
</dd></dl>

<dl class="method">
<dt id="btree.BTreeNode.optimize">
<tt class="descname">optimize</tt><big>(</big><em>i</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/btree.html#BTreeNode.optimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.BTreeNode.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimizes and rebalances the current node</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Its use is experimental and it is not yet fully working</p>
</div>
</dd></dl>

<dl class="method">
<dt id="btree.BTreeNode.print">
<tt class="descname">print</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/btree.html#BTreeNode.print"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.BTreeNode.print" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints info about the BTreeNode</p>
</dd></dl>

<dl class="method">
<dt id="btree.BTreeNode.replace_key">
<tt class="descname">replace_key</tt><big>(</big><em>i</em>, <em>key</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/btree.html#BTreeNode.replace_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.BTreeNode.replace_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces keys[i] with the given key and write changes</p>
</dd></dl>

<dl class="method">
<dt id="btree.BTreeNode.split_child">
<tt class="descname">split_child</tt><big>(</big><em>i</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/btree.html#BTreeNode.split_child"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.BTreeNode.split_child" title="Permalink to this definition">¶</a></dt>
<dd><p>This function splits a node in the following way:
self: (...x, key[i]=k, ...) ==&gt; self: (...x, key&#8217;[i], y, key&#8217;[i+1]=k...)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="btree.B_tree_delete">
<tt class="descclassname">btree.</tt><tt class="descname">B_tree_delete</tt><big>(</big><em>tr</em>, <em>key</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/btree.html#B_tree_delete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.B_tree_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a key in a given btree</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tr</strong> (<a class="reference internal" href="#btree.BTreeNode" title="btree.BTreeNode"><tt class="xref py py-class docutils literal"><span class="pre">BTreeNode</span></tt></a>) &#8211; the root of the btree</li>
<li><strong>key</strong> (<em>integer / string</em>) &#8211; the key to delete</li>
<li><strong>file</strong> (<em>file descriptor</em>) &#8211; the index file</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="btree.B_tree_insert">
<tt class="descclassname">btree.</tt><tt class="descname">B_tree_insert</tt><big>(</big><em>tr</em>, <em>key</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/btree.html#B_tree_insert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.B_tree_insert" title="Permalink to this definition">¶</a></dt>
<dd><p>It operates as a wrapper for <a class="reference internal" href="#btree.B_tree_insert_nonfull" title="btree.B_tree_insert_nonfull"><tt class="xref py py-func docutils literal"><span class="pre">B_tree_insert_nonfull()</span></tt></a>, that checks if parent node is full and do the necessary operations for insertion</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tr</strong> (<a class="reference internal" href="#btree.BTreeNode" title="btree.BTreeNode"><tt class="xref py py-class docutils literal"><span class="pre">BTreeNode</span></tt></a>) &#8211; the root of the subtree</li>
<li><strong>key</strong> (<em>integer / string</em>) &#8211; the key to delete</li>
<li><strong>file</strong> (<em>file descriptor</em>) &#8211; the index file</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="btree.B_tree_insert_nonfull">
<tt class="descclassname">btree.</tt><tt class="descname">B_tree_insert_nonfull</tt><big>(</big><em>tr</em>, <em>key</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/btree.html#B_tree_insert_nonfull"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.B_tree_insert_nonfull" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts a key in a given subtree</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tr</strong> (<a class="reference internal" href="#btree.BTreeNode" title="btree.BTreeNode"><tt class="xref py py-class docutils literal"><span class="pre">BTreeNode</span></tt></a>) &#8211; the root of the subtree</li>
<li><strong>key</strong> (<em>integer / string</em>) &#8211; the key to delete</li>
<li><strong>file</strong> (<em>file descriptor</em>) &#8211; the index file</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>if the given node is a leaf inserts the key into the node calling <a class="reference internal" href="#btree.ordered_insert" title="btree.ordered_insert"><tt class="xref py py-func docutils literal"><span class="pre">ordered_insert()</span></tt></a>
otherwise tries to insert the key into the child nodes of the given node</p>
</dd></dl>

<dl class="function">
<dt id="btree.B_tree_search">
<tt class="descclassname">btree.</tt><tt class="descname">B_tree_search</tt><big>(</big><em>tr</em>, <em>key</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/btree.html#B_tree_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.B_tree_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches for a key in a given btree</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tr</strong> (<a class="reference internal" href="#btree.BTreeNode" title="btree.BTreeNode"><tt class="xref py py-class docutils literal"><span class="pre">BTreeNode</span></tt></a>) &#8211; the root of the btree</li>
<li><strong>key</strong> (<em>integer / string</em>) &#8211; the key to search for</li>
<li><strong>file</strong> (<em>file descriptor</em>) &#8211; the index file</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="btree.ordered_insert">
<tt class="descclassname">btree.</tt><tt class="descname">ordered_insert</tt><big>(</big><em>lst</em>, <em>x</em><big>)</big><a class="reference internal" href="_modules/btree.html#ordered_insert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#btree.ordered_insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that inserts element x in lst in ascending order</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lst</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; list to insert to</li>
<li><strong>x</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><em>object</em></a>) &#8211; object to insert</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">db-project Package</a><ul>
<li><a class="reference internal" href="#testbench-module"><tt class="docutils literal"><span class="pre">testbench</span></tt> module</a></li>
<li><a class="reference internal" href="#db-module"><tt class="docutils literal"><span class="pre">db</span></tt> module</a></li>
<li><a class="reference internal" href="#btree-module"><tt class="docutils literal"><span class="pre">btree</span></tt> module</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="#">db-project 1.2.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Spyros Seimenis.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>